<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SKIP THE COURIER</title>

    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link rel="icon" href="navbar.png" type="image/x-icon" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
    <style>
      body {
        font-family: Arial, sans-serif;
      }

      #input_Id {
        background-color: #f5f7fa;
      }

      #packageType {
        background-color: #f5f7fa;
      }

      #packageWeight {
        background-color: #f5f7fa;
      }

      #packageDescription {
        background-color: #f5f7fa;
      }

      .hr_tag {
        height: 4px;
        background-color: green;
        border: none;
      }

      .header {
        padding: 10px;
        text-align: center;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .submit-button {
        padding: 10px 20px;
        border: none;
        cursor: pointer;
        width: 100%;
        font-size: 16px;
        background-color: #28cb8b;
      }

      .submit-button:hover {
        background-color: #81c784;
      }
    </style>
  </head>

  <body>
    <!-- Header -->
    <div id="header"></div>

    <div class="header">
      <h1>Request for Delivery</h1>
    </div>

    <div class="container">
      <div class="form-group">
        <label for="senderName">Sender Information</label>
        <input
          type="text"
          placeholder="First Name"
          class="form-control"
          id="input_Id"
          required
        /><br />
        <input
          type="text"
          placeholder="Phone Number"
          class="form-control"
          id="input_Id"
          required
        /><br />

        <label for="senderName">Sender Address</label>
        <input
          type="text"
          placeholder="Street Address"
          class="form-control"
          id="input_Id"
          required
        /><br />
        <input
          type="text"
          placeholder="Apt/Unit"
          class="form-control"
          id="input_Id"
          required
        /><br />
        <input
          type="text"
          placeholder="Postal Code"
          class="form-control"
          id="input_Id"
          required
        /><br />
        <select
          type="text"
          placeholder="Province"
          class="form-control"
          id="input_Id"
          required
        >
          <br />
          <option value="Province">Province</option>
          <option value="Alberta">Alberta</option>
          <option value="British Columbia">British Columbia</option>
          <option value="Manitoba">Manitoba</option>
          <option value="New Brunswick">New Brunswick</option>
          <option value="Newfoundland and Labrador">
            Newfoundland and Labrador
          </option>
          <option value="Nova Scotia">Nova Scotia</option>
          <option value="Ontario">Ontario</option>
          <option value="Prince Edward Island">Prince Edward Island</option>
          <option value="Quebec">Quebec</option>
          <option value="Saskatchewan">Saskatchewan</option>
        </select>
        <br />
        <input
          type="text"
          placeholder="City"
          class="form-control"
          id="input_Id"
          required
        /><br />
        <input
          type="text"
          placeholder="Country"
          class="form-control"
          id="input_Id"
          required
        /><br />
      </div>

      <h1 class="text-center">Receiver Details</h1>

      <div class="form-group">
        <label for="senderName">Receiver Information</label>
        <input
          type="text"
          placeholder="First Name"
          class="form-control"
          id="input_Id"
          required
        /><br />
        <input
          type="text"
          placeholder="Phone Number"
          class="form-control"
          id="input_Id"
          required
        /><br />

        <label for="senderName">Receiver Address</label>
        <input
          type="text"
          placeholder="Street Address"
          class="form-control"
          id="input_Id"
          required
        /><br />
        <input
          type="text"
          placeholder="Apt/Unit"
          class="form-control"
          id="input_Id"
          required
        /><br />
        <input
          type="text"
          placeholder="Postal Code"
          class="form-control"
          id="input_Id"
          required
        /><br />
        <select
          type="text"
          placeholder="Province"
          class="form-control"
          id="input_Id"
          required
        >
          <br />
          <option value="Province">Province</option>
          <option value="Alberta">Alberta</option>
          <option value="British Columbia">British Columbia</option>
          <option value="Manitoba">Manitoba</option>
          <option value="New Brunswick">New Brunswick</option>
          <option value="Newfoundland and Labrador">
            Newfoundland and Labrador
          </option>
          <option value="Nova Scotia">Nova Scotia</option>
          <option value="Ontario">Ontario</option>
          <option value="Prince Edward Island">Prince Edward Island</option>
          <option value="Quebec">Quebec</option>
          <option value="Saskatchewan">Saskatchewan</option>
        </select>
        <br />
        <input
          type="text"
          placeholder="City"
          class="form-control"
          id="input_Id"
          required
        /><br />
        <input
          type="text"
          placeholder="Country"
          class="form-control"
          id="input_Id"
          required
        /><br />
      </div>

      <h1 class="text-center">Package Information</h1>

      <div class="form-group">
        <label for="packageType">Package Type</label>
        <select class="form-control" id="packageType" required>
          <option value="document">Type</option>
          <option value="parcel">Parcel</option>
          <option value="envelope">Envelope</option>
        </select>
      </div>

      <div class="form-group">
        <label for="packageWeight">Package Weight (in kg)</label>
        <input type="number" class="form-control" id="packageWeight" required />
      </div>

      <div class="form-group">
        <label for="packageDescription">Package Description</label>
        <textarea
          class="form-control"
          id="packageDescription"
          rows="3"
          required
        ></textarea>
      </div>

      <button type="submit" class="submit-button" id="submit-button">
        Submit
      </button>
    </div>

    <!--- Footer -->
    <div id="footer"></div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $(function () {
        $("#header").load("index.html");
      });
    </script>
    <script>
      $(function () {
        $("#footer").load("footer.html");
      });
    </script>
    <script>
      function obtainCookie(name) {
        // Add the = sign
        name = name + "=";

        // Get the decoded cookie
        var decodedCookie = decodeURIComponent(document.cookie);

        // Get all cookies, split on ; sign
        var cookies = decodedCookie.split(";");

        // Loop over the cookies
        for (var i = 0; i < cookies.length; i++) {
          // Define the single cookie, and remove whitespace
          var cookie = cookies[i].trim();

          // If this cookie has the name of what we are searching
          if (cookie.indexOf(name) == 0) {
            // Return everything after the cookies name
            return cookie.substring(name.length, cookie.length);
          }
        }
      }

      document.getElementById("submit-button").addEventListener("click", () => {
        const tokenId = obtainCookie("tokenId");
        if (tokenId == null) {
          window.location.href = "Loginpage.html";
        } else {
          // call request delivery backend
          const url = "http://localhost:8080/requestForDelivery";
          const requestJson = {
            // Update this to get values from form but keep the same name (locationFrom, locationTo)
            locationFrom: "Toronto",
            locationTo: "Montreal",
            // TODO: get values from form
          };
          var params = {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              idToken: tokenId,
              requestJson: requestJson,
            }),
          };
          fetch(url, params)
            .then((response) => {
              if (response.ok) {
                response.json().then((res) => {
                  // Redirect to payment page
                  window.location.href = "Paymentpage.html";
                });
              } else {
                response.text().then((text) => {
                  alert(text);
                });
              }
            })
            .catch((error) => {
              // Handle errors here
              alert(error);
              console.error("Error:", error);
            });
        }
      });
    </script>
  </body>
</html>
